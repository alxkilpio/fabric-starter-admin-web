<template>
  <require from="css/style.css"></require>

  <div class="my-1" style="height: 25px">
    <div class="d-inline p-2 text-white mr-1" id="block" style="background-color: #000000;" repeat.for="o of blocks"
         data-toggle="tooltip" data-placement="left" title="${o.txid}">
      ${o.blockNumber}
    </div>
  </div>

  <div class="row">

    <div class="col-md-4">

      <form>
        <h4 t="channelList">channelList</h4>
        <div repeat.for="o of channelList">
          <label>
            <input type="radio" value.bind="o" autocomplete="off" checked.bind='channel'
                   change.delegate="queryChaincodes() || queryBlocks() || queryOrgs() || queryPeers() || getLastBlock()">
            ${o}
          </label>
        </div>
      </form>

      <form submit.delegate="addChannel()">
        <div class="form-row align-items-center">
          <div class="col-auto">
            <input type="text" class="form-control" value.bind="channelNew" required t="[placeholder]New channel">
          </div>
          <div class="col-auto my-1">
            <button type="submit" class="btn" t="Add channel">Add channel</button>
          </div>
          <div class="col-auto my-1" hide.bind="loadAdd">
            <div class="spinner-grow" role="status">
              <span class="sr-only">Loading...</span>
            </div>
          </div>
        </div>
      </form>

      <form submit.delegate="joinChannel()">
        <div class="form-row align-items-center my-1">
          <div class="col-auto">
            <input type="text" class="form-control" value.bind="channelJoin" required t="[placeholder]Join channel">
          </div>
          <div class="col-auto">
            <button type="submit" class="btn " t="Join channel">Join channel</button>
          </div>
          <div class="col-auto my-1" hide.bind="loadJ">
            <div class="spinner-grow" role="status">
              <span class="sr-only">Loading...</span>
            </div>
          </div>
        </div>
      </form>

      <!--<form submit.delegate="addToConsortium()">-->
      <!--<h4 t="Consortium">Consortium</h4>-->
      <!--<div class="form-row align-items-center my-1">-->
      <!--<div class="col-10">-->
      <!--<table class="table table-bordered my-1">-->
      <!--<thead class="text-white" style="background-color: #000000">-->
      <!--<tr>-->
      <!--<th scope="col">Name</th>-->
      <!--<th scope="col">Ip</th>-->
      <!--</tr>-->
      <!--</thead>-->
      <!--<tbody>-->
      <!--<tr repeat.for="org of consortiumMembersList">-->
      <!--<td>${org}</td>-->
      <!--</tr>-->
      <!--</tbody>-->
      <!--</table>-->
      <!--</div>-->
      <!--</div>-->

      <!--<div class="form-row align-items-center my-1">-->
      <!--<div class="col-auto">-->
      <!--<label for="ip" t="IP">IP</label>-->
      <!--<input type="text" id="ip" readonly class="form-control" value.bind="consortiumInviteeIP"-->
      <!--placeholder="IP address of org" autocomplete="off" required>-->
      <!--</div>-->
      <!--<div class="col-auto">-->
      <!--<label for="name" t="Name">Name</label>-->
      <!--<input type="text" id="name" class="form-control" value.bind="consortiumInviteeName"-->
      <!--placeholder="Name of org" required>-->
      <!--</div>-->
      <!--</div>-->
      <!--<div class="form-row align-items-center my-1">-->
      <!--<div class="col-auto">-->
      <!--<button type="submit" class="btn " t="Invite">Invite</button>-->
      <!--</div>-->
      <!--</div>-->
      <!--</form>-->

      <form submit.delegate="installChaincode()">
        <h4 t="Uploaded Chaincodes">Uploaded Chaincodes</h4>
        <ul>
          <li repeat.for="o of installedChaincodes">${o}</li>
        </ul>
        <div class="form-row align-items-center">
          <div class="col-auto">
            <input class="form-control-file" type="file"
                   name="ChaincodeFile"
                   files.bind="chaincodeFile" required accept="application/zip">
          </div>
        </div>
        <div class="form-row align-items-center">
          <div class="col-auto">
            <label for="installLanguage" t="Language">Language</label>
            <select id="installLanguage" class="form-control" value.bind="installLanguage">
              <option value="node">node</option>
              <option value="car">car</option>
              <option value="golang">golang</option>
              <option value="java">java</option>
            </select>
          </div>
          <div class="col-auto">
            <label for="installVersion" t="Version">Version:</label>
            <input type="text" id="installVersion" class="form-control" value.bind="installVersion" placeholder="1.0">
          </div>
        </div>
        <div class="form-row align-items-center my-1">
          <div class="col-auto">
            <button type="submit" class="btn " t="Install chaincode">Install chaincode</button>
          </div>
        </div>
      </form>

      <form submit.delegate="installWebApp()">
        <h4 t="Uploaded WebApps">Web Applications</h4>
        <ul>
          <li repeat.for="app of installedWebApps"><a href="/webapps/${app}">${app}</a></li>
        </ul>
        <div class="form-row align-items-center">
          <div class="col-auto">
            <input class="form-control-file" type="file"
                   name="webAppFile" files.bind="webAppFile" required accept="application/zip">
          </div>
        </div>
        <button type="submit" class="btn  my-1" t="Install Web App">Install Web App</button>
      </form>

      <form submit.delegate="installMiddleware()">
        <h4 t="Uploaded Middlewares">Middlewares</h4>
        <ul>
          <li repeat.for="item of installedMiddlewares">${item}</a></li>
        </ul>
        <div class="form-row align-items-center">
          <div class="col-auto">
            <input class="form-control-file" type="file"
                   name="middlewareFile" files.bind="middlewareFile" required accept="text/javascript">
          </div>
        </div>
        <button type="submit" class="btn my-1" t="Install Middleware">Install Middleware</button>
      </form>
    </div>

    <div class="col-md-4" hide.bind="!channel">

      <form>
        <h4 t="chaincodeList">chaincodeList</h4>
        <div repeat.for="o of chaincodeList">
          <label>
            <input type="radio" value.bind="o" autocomplete="off" checked.bind='selectedChaincode'
                   change.delegate="hideTx()">
            ${o}
          </label>
        </div>
      </form>

      <form>
        <h4 t="Instantiate chaincode">Instantiate chaincode</h4>
        <div class="form-row align-items-center">
          <div class="col-auto">
            <label for="initChaincode" t="Chaincode for instantiate">Chaincode for instantiate</label>
            <select class="form-control" id="initChaincode" value.bind="selectedChain" required>
              <option repeat.for="chain of installedChaincodes">
                ${chain}
              </option>
            </select>
          </div>
        </div>
        <div class="form-row align-items-center">
          <div class="col-auto">
            <label for="initLanguage" t="Language">Language</label>
            <select class="form-control" id="initLanguage" value.bind="initLanguage">
              <option value="node">node</option>
              <option value="car">car</option>
              <option value="golang">golang</option>
              <option value="java">java</option>
            </select>
          </div>
          <div class="col-auto">
            <label for="initFcn" t="Function">Function</label>
            <input class="form-control" id="initFcn" type="text" value.bind="initFcn"
                   placeholder="init">
          </div>
        </div>

        <div class="form-row align-items-center">
          <div class="col-10">
            <label for="initArgs" t="Arguments">Arguments</label>
            <textarea class="form-control" id="initArgs" type="text" value.bind="initArgs"
                      placeholder="a 10 b 5"></textarea>
          </div>
        </div>
        <div class="form-row align-items-center">
          <div class="col-10">
            <label for="policy" t="Policy">Policy</label>
            <textarea class="form-control" style="height:225px" id="policy" type="text" value.bind="policy"
                      placeholder="{
  &quot;identities&quot;: [
            { &quot;role&quot;: { &quot;name&quot;: &quot;member&quot;, &quot;mspId&quot;: &quot;org1&quot; }},
            { &quot;role&quot;: { &quot;name&quot;: &quot;member&quot;, &quot;mspId&quot;: &quot;org2&quot; }}
  ],
  &quot;policy&quot;: {
            &quot;1-of&quot;: [{ &quot;signed-by&quot;: 0 }, { &quot;signed-by&quot;: 1 }]
  }
}"></textarea>
          </div>
        </div>
        <div class="form-row align-items-center">
          <div class="col-auto">
            <label for="collection" t="Collection">Collection</label>
            <input class="form-control-file" id="collection" type="file"
                   name="webAppFile" files.bind="privateCollectionFile" accept="application/json">
          </div>
        </div>
        <div class="form-row align-items-center my-1">
          <div class="col-auto">
            <button type="submit" class="btn " t="Instantiate chaincode" click.trigger="initChaincode()">
              Instantiate Chaincode
            </button>
          </div>
          <div class="col-auto">
            <button type="submit" class="btn " t="Upgrade Chaincode" click.trigger="upgradeChaincode()">
              Upgrade Chaincode
            </button>
          </div>
          <div class="col-auto my-1" hide.bind="loadI">
            <div class="spinner-grow" role="status">
              <span class="sr-only">Loading...</span>
            </div>
          </div>
        </div>
      </form>

      <form submit.delegate="addOrgToChannel()">
        <h4 t="orgList">orgList</h4>
        <ul>
          <li repeat.for="o of orgList">${o}</li>
        </ul>
        <div class="form-row align-items-center">
          <div class="col-auto">
            <input type="text" class="form-control" value.bind="newOrg" required t="[placeholder]New Organizatoin">
          </div>
          <div class="col-auto">
            <button type="submit" class="btn " t="Add Organization to Channel">Add Organization to
              Channel
            </button>
          </div>
        </div>
      </form>
    </div>

    <div class="col-md-4" hide.bind="!selectedChaincode">

      <form>
        <h4 t="Targets">Targets</h4>
        <div repeat.for="o of targets">
          <label>
            <input type="checkbox" value.bind="o" checked.bind="targs">
            ${o}
          </label>
        </div>
        <div class="form-row align-items-center">
          <div class="col-10">
            <label for="invFunction" t="Function">Function</label>
            <input class="form-control" id="invFunction" type="text" value.bind="fnc" placeholder="put" required>
          </div>
        </div>
        <div class="form-row align-items-center my-1">
          <div class="col-10">
            <label for="invValue" t="Arguments">Value</label>
            <textarea class="form-control" id="invValue" type="text" value.bind="value"
                      placeholder="&quot;account&quot; &quot;one two&quot; {JSON}"></textarea>
          </div>
        </div>
        <div class="form-row align-items-center">
          <div class="col-auto">
            <button type="submit" class="btn  mb-2" click.trigger="getInvoke()">
              Invoke
            </button>
          </div>
          <div class="col-auto">
            <button type="submit" class="btn  mb-2" click.trigger="getQuery()">
              Query
            </button>
          </div>
          <div class="col-auto" hide.bind="load">
            <div class="spinner-grow" role="status">
              <span class="sr-only">Loading...</span>
            </div>
          </div>
        </div>
      </form>

      <div class="form-group mb-2" hide.bind="!lastTx">
        <h4 class="text" t="Transaction">Transaction</h4>
        <h5 class="text" t="Result">Result</h5>
        <pre id="res"></pre>
        <h5 class="text" t="Input" hide.bind="!qu">Input</h5>
        <pre id="input"></pre>
        <h5 class="text" t="ReadSet" hide.bind="!qu">ReadSet</h5>
        <pre id="reads"></pre>
        <h5 class="text" t="WriteSet" hide.bind="!qu">WriteSet</h5>
        <pre id="writes"></pre>
      </div>

      <div class="form-group mb-2" hide.bind="!qu">
        <div>
          <h4 class="text" t="Endorsed">Endorsed</h4>
          <h5 class="text" t="Creator">Creator</h5>
          <div>
            ${creator}
            <pre id="${creator}"></pre>
            <button type="submit" class="btn btn-xs" click.trigger="queryCert(creator, true)">
              Show cert
            </button>
          </div>
          <h5 class="text" t="Endorsers">Endorsers</h5>
          <div repeat.for="o of endorses">
            ${o}
            <pre id="${o}"></pre>
            <button type="submit" class="btn btn-xs" click.trigger="queryCert(o)">
              Show cert
            </button>
          </div>
        </div>
      </div>

      <div class="form-group mb-2" hide.bind="!qu">
        <h4 class="text" t="Block">Block</h4>
        <pre id="json"></pre>
      </div>
    </div>
  </div>
  <br>
</template>
